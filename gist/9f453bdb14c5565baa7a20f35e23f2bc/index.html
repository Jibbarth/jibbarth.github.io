<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
                    <title>ðŸ‡«ðŸ‡· API Platform, Oauth, &amp; Swagger UI // JibÃ© Barth</title>
                        <meta name="author" content="JibÃ© Barth">
            <meta name="description" content="Api Platform, OAuth &amp; Swagger
Aujourd'hui, nous allons voir comment utiliser une authentification OAuth, pour notre projet API Platform, Ã  travers Swagger UI.
Cela nous permettra d'activer plus...
">
            <meta name="image" content="https://images.unsplash.com/photo-1558986377-c44f6a2b50f0?crop=entropy&amp;cs=tinysrgb&amp;fit=crop&amp;fm=jpg&amp;h=300&amp;ixid=eyJhcHBfaWQiOjF9&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=600">
                        <meta itemprop="name" content="ðŸ‡«ðŸ‡· API Platform, Oauth, &amp; Swagger UI // JibÃ© Barth">
            <meta itemprop="description" content="Api Platform, OAuth &amp; Swagger
Aujourd'hui, nous allons voir comment utiliser une authentification OAuth, pour notre projet API Platform, Ã  travers Swagger UI.
Cela nous permettra d'activer plus...
">
            <meta itemprop="image" content="https://images.unsplash.com/photo-1558986377-c44f6a2b50f0?crop=entropy&amp;cs=tinysrgb&amp;fit=crop&amp;fm=jpg&amp;h=300&amp;ixid=eyJhcHBfaWQiOjF9&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=600">
                        <meta name="twitter:card" content="summary_large_image">
            <meta name="twitter:site" content="@Jibbarth">
            <meta name="twitter:creator" content="@Jibbarth">
            <meta name="twitter:image" content="https://images.unsplash.com/photo-1558986377-c44f6a2b50f0?crop=entropy&amp;cs=tinysrgb&amp;fit=crop&amp;fm=jpg&amp;h=300&amp;ixid=eyJhcHBfaWQiOjF9&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=600">
                        <meta name="og:title" content="ðŸ‡«ðŸ‡· API Platform, Oauth, &amp; Swagger UI // JibÃ© Barth">
            <meta name="og:description" content="Api Platform, OAuth &amp; Swagger
Aujourd'hui, nous allons voir comment utiliser une authentification OAuth, pour notre projet API Platform, Ã  travers Swagger UI.
Cela nous permettra d'activer plus...
">
            <meta name="og:image" content="https://images.unsplash.com/photo-1558986377-c44f6a2b50f0?crop=entropy&amp;cs=tinysrgb&amp;fit=crop&amp;fm=jpg&amp;h=300&amp;ixid=eyJhcHBfaWQiOjF9&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=600">
            <meta name="og:url" content="https://xn--jibbarth-d1a.fr">
            <meta name="og:site_name" content="JibÃ© Barth">
            <meta name="og:type" content="article">
            <link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Rss feed for https://jibÃ©barth.fr">
                                <link rel="stylesheet" href="/dist/tailwind.css">
            <link rel="stylesheet" href="/dist/1.css"><link rel="stylesheet" href="/dist/app.css">
        
    <link rel="stylesheet" href="/dist/0.css"><link rel="stylesheet" href="/dist/gist.css">
    </head>
    <body class="flex flex-col min-h-screen bg-gray-300 font-sans">
        <header>
                        <div class="bg-gray-100 mb-6 pb-6 w-full h-auto flex flex-col items-center shadow-sm">
                <div class="h-64 xl:h-full w-full">
                        <img class="h-full w-full object-cover" src="data:image/png;base64, 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">
                </div>
                <div class="-ml-56 sm:w-64">
                    <div class="shadow h-32 w-32 -my-16 border-white rounded-full overflow-hidden border-4">
                        <a href="/">
                            <img class="object-cover w-full h-full" src="https://gravatar.com/avatar/f7a23636c530faa0ceca6199226902e7?s=200">
                        </a>
                    </div>
                </div>
                <div class="mt-16 sm:mt-4">
                    <h1 class="text-3xl text-center font-bold">
                        JibÃ© Barth
                    </h1>
                    <p class="text-sm text-gray-600 text-center">
                        ðŸ‡«ðŸ‡· Web developer
                        <div class="text-center">
                            <a
        href="https://github.com/Jibbarth"
        title="Github"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-github text-gray-600 hover:text-black"></i>
    </a>
    <a
        href="https://twitter.com/jibbarth"
        title="Twitter"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-twitter text-gray-600 hover:text-black"></i>
    </a>
    <a
        href="https://linkedin.com/in/jibÃ©-b-772884a3"
        title="Linkedin"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-linkedin text-gray-600 hover:text-black"></i>
    </a>
    <a
        href="https://connect.symfony.com/profile/jibbarth"
        title="Symfony"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-symfony text-gray-600 hover:text-black"></i>
    </a>

                        </div>
                    </p>
                </div>
                <div class="mt-4 pt-3 flex flex-wrap mx-6 border-t justify-center">
                        <div class="text-center mt-1">
        <h2 class="block text-gray-800 text-2xl font-semibold">ðŸ‡«ðŸ‡· API Platform, Oauth, &amp; Swagger UI</h2>
        <p class="inline-block text-gray-600 text-sm font-base">Published Jan 11, 2020</p>
    </div>
                </div>
            </div>
                    </header>
        <main class="flex-grow">
                <div class="flex flex-col items-center">
        <div class="bg-gray-100 p-6 w-full max-w-4xl">
            <div class="markdown">
                <h1><a id="user-content-api-platform-oauth--swagger" href="#api-platform-oauth--swagger" name="api-platform-oauth--swagger" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Api Platform, OAuth &amp; Swagger</h1>
<p>Aujourd'hui, nous allons voir comment utiliser une authentification OAuth, pour notre projet API Platform, Ã  travers Swagger UI.</p>
<p>Cela nous permettra d'activer plusieurs services OAuth, tels que Google, Github, ou encore Facebook.</p>
<blockquote>
<p>Je pars du principe que si vous arrivez la, vous connaissez un minimum l'utilisation de Symfony et de API-Platform. Je vais donc passer trÃ¨s vite sur l'initialisation.</p>
</blockquote>
<h3><a id="user-content-toc" href="#toc" name="toc" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TOC</h3>
<ul>
<li>
<a href="#cr%C3%A9ation-dun-projet">CrÃ©ation d'un projet</a>
</li>
<li>
<a href="#initialisation-de-la-plateforme">Initialisation de la plateforme</a>
</li>
<li>
<a href="#cr%C3%A9ation-dun-endpoint-de-test">CrÃ©ation d'un endpoint de test</a>
</li>
<li>
<a href="#r%C3%A9cup%C3%A9rer-des-cr%C3%A9dentials-oauth-pour-se-connecter-avec-google">RÃ©cupÃ©rer des crÃ©dentials Oauth pour se connecter avec Google</a>
</li>
<li>
<a href="#authentication">Authentication</a>
</li>
<li>
<a href="#un-autre-oauth-provider--github">Un autre OAuth provider : Github</a>
</li>
<li>
<a href="#plusieurs-oauth-login-sur-swagger-ui">Plusieurs OAuth Login sur Swagger UI</a>
</li>
</ul>
<h2><a id="user-content-crÃ©ation-dun-projet" href="#crÃ©ation-dun-projet" name="crÃ©ation-dun-projet" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CrÃ©ation d'un projet</h2>
<p>Pour notre projet, nous allons rapidement crÃ©er une application symfony avec API-Platform</p>
<pre><code class="language-bash">composer create-project symfony/website-skeleton api-oauth
cd api-oauth
composer req api
symfony local:server:start -d
</code></pre>
<blockquote>
<p>J'utilise le website-skeleton pour avoir tous les composants Symfony, et ne pas a avoir a faire de multiples <code>composer require</code>. L'utilisateur aguerri partira bien Ã©videmment du <code>skeleton</code> tout cours.</p>
</blockquote>
<h2><a id="user-content-initialisation-de-la-plateforme" href="#initialisation-de-la-plateforme" name="initialisation-de-la-plateforme" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initialisation de la plateforme</h2>
<p>Premierement, nous allons altÃ©rer la configuration d'api platform, pour repasser sur swagger v2 plutot que la v3.</p>
<pre><code class="language-yaml"># config/packages/api_platform.yml
api_platform:
    #...
    swagger:
        versions: [2]
</code></pre>
<blockquote>
<p>Cette Ã©tape pourra Ãªtre Ã©vitÃ© quand <a href="https://github.com/api-platform/core/pull/3333">cette PR</a> sera mergÃ©e et released.</p>
</blockquote>
<p>Puis, crÃ©ons une entitÃ© de test :</p>
<pre><code class="language-bash">php bin/console make:entity Book --api-resource
</code></pre>
<p>Et une entitÃ©e user (sans besoin de hash password )</p>
<pre><code class="language-bas">php bin/console make:user
</code></pre>
<p>Et on met Ã  jour la BDD.</p>
<pre><code class="language-bash">php bin/console d:s:u --force
</code></pre>
<h2><a id="user-content-crÃ©ation-dun-endpoint-de-test" href="#crÃ©ation-dun-endpoint-de-test" name="crÃ©ation-dun-endpoint-de-test" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CrÃ©ation d'un endpoint de test</h2>
<p>Nous allons crÃ©Ã© un endpoint de test qui se contentera de retourner l'utilisateur.</p>
<pre><code class="language-bash">php bin/console make:controller WhoAmIController --no-template
</code></pre>
<p>Alterons ce controleur pour le rendre invokable, et pour retourner l'utilisateur courant :</p>
<pre><code class="language-php">// src/Controller/WhoAmIController.php
&lt;?php
declare(strict_types=1);

namespace App\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\Routing\Annotation\Route;
use Symfony\Component\Security\Core\User\UserInterface;

final class WhoAmIController extends AbstractController
{
    public function __invoke(): ?UserInterface
    {
        return $this-&gt;getUser();
    }
}
</code></pre>
<p>Allons modifier la classe <code>User</code> pour la dÃ©finir en tant que ressource ApiPlatform, et ajoutons dedans notre controller.</p>
<pre><code class="language-php">// src/Entity/User.php
&lt;?php
declare(strict_types=1);
    
namespace App\Entity;

use ApiPlatform\Core\Annotation\ApiResource;
use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Security\Core\User\UserInterface;
use App\Controller\WhoAmIController;

/**
 * @ApiResource(
 *     collectionOperations={
 *          &quot;get&quot;, &quot;post&quot;,
 *          &quot;whoami&quot;= {
 *              &quot;method&quot;=&quot;GET&quot;,
 *              &quot;path&quot;=&quot;/whoami&quot;,
 *              &quot;controller&quot;=WhoAmIController::class,
 *          },
 *     }
 * )
 * @ORM\Entity(repositoryClass=&quot;App\Repository\UserRepository&quot;)
 */
class User implements UserInterface 
{
    // ...
}
</code></pre>
<p>Je rajoute le controleur dans les <code>collectionOperations</code> , mais il conviendrai mieux dans <code>itemOperations</code>. Je ne souhaites juste pas m'embÃªter a devoir enlever le champ <code>id</code> du swagger pour l'instant.</p>
<p>Si on exÃ©cute le endpoint <code>/api/whoami</code>, on reÃ§oit <code>null</code>. Parfait. Passons Ã  l'OAuth.</p>
<h2><a id="user-content-rÃ©cupÃ©rer-des-crÃ©dentials-oauth-pour-se-connecter-avec-google" href="#rÃ©cupÃ©rer-des-crÃ©dentials-oauth-pour-se-connecter-avec-google" name="rÃ©cupÃ©rer-des-crÃ©dentials-oauth-pour-se-connecter-avec-google" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RÃ©cupÃ©rer des crÃ©dentials Oauth pour se connecter avec Google</h2>
<p>Notre premier authenticator sera Google.
Depuis la <a href="https://console.developers.google.com/apis/credentials">console developper</a>, crÃ©eons d'abord un &quot;Ecran d'autorisation Oauth&quot;. (Il n'est pas nÃ©cessaire de renseigner les domaines pour l'instant).</p>
<p>Puis, toujours dans cette console, crÃ©eons des identifiants &quot;ID Client Oauth&quot;.</p>
<p>Ici, il est important de rajouter une Url de redirection autorisÃ©e ainsi en adaptant votre domaine:</p>
<pre><code class="language-bash">https://127.0.0.1:8000/bundles/apiplatform/swagger-ui/oauth2-redirect.html
</code></pre>
<p>Puis on stock notre ID et SECRET dans le fichier <code>.env</code></p>
<pre><code class="language-ini">#.env
# ...
OAUTH_GOOGLE_ID=&quot;monid&quot;
OAUTH_GOOGLE_SECRET=&quot;monsecret&quot;
</code></pre>
<p>Completons la configuration d'API Platform :</p>
<pre><code class="language-yaml"># config/packages/api_platform.yaml
api_platform:
    # ...
    oauth:
        enabled: true
        clientId: '%env(OAUTH_GOOGLE_ID)%'
        clientSecret: '%env(OAUTH_GOOGLE_SECRET)%'
        type: 'oauth2'
        # The oauth flow grant type.
        flow: 'authorizationCode'
        # The oauth authentication url.
        authorizationUrl: 'https://accounts.google.com/o/oauth2/v2/auth'
        # The oauth token url.
        tokenUrl: 'https://www.googleapis.com/oauth2/v4/token'
        # The oauth scopes.
        scopes:
            email: 'Allow to retrieve user email'
</code></pre>
<p>Nous pouvons maintenant tester l'authorization depuis notre UI Swagger.</p>
<p>Une barre apparait avec un bouton &quot;Authorize&quot; dans la documentation :</p>
<p><img src="https://user-images.githubusercontent.com/3168281/72219427-e5a08180-353d-11ea-99c8-228bf401dc98.png" alt="image" /></p>
<p>Lorsqu'on clique dessus, une popin apparait :</p>
<p><img src="https://user-images.githubusercontent.com/3168281/72219423-df120a00-353d-11ea-8f81-6405fdde5c80.png" alt="image" /></p>
<p>On reclique sur Authorize, un nouvel onglet s'ouvre sur Google, puis nous somme redirigÃ© sur la documentation.
L'OAuth s'est bien passÃ©.</p>
<h2><a id="user-content-authentication" href="#authentication" name="authentication" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Authentication</h2>
<p>Nous sommes a prÃ©sent bien connectÃ© via l'Oauth de google. Pour chaque appel que nous faisons a l'API, un header <code>Authorization: Bearer accessToken</code> est ajoutÃ©.</p>
<p>Mais si nous appelons le endpoint <code>/api/whoami</code>, il retourne toujours <code>null</code>.
Voyons comment rÃ©cupÃ©rer notre utilsateur.</p>
<p>Tout d'abord, gÃ©nÃ©rons un GuardAuthenticator :</p>
<pre><code class="language-bash">php bin/console make:auth
</code></pre>
<p>Lorsque cette commande le demande, choisissez &quot;Empty Authenticator&quot;</p>
<p>Puis rÃ©cupÃ©rons league/oauth2-google</p>
<pre><code class="language-bash">composer require league/oauth2-google
</code></pre>
<p>Dans notre <code>services.yaml</code>, crÃ©eons un service pour le google Provider</p>
<pre><code class="language-yaml">services:
    # ...
    League\OAuth2\Client\Provider\Google:
        class: League\OAuth2\Client\Provider\Google
        arguments:
            - {clientId: '%env(OAUTH_GOOGLE_ID)%', clientSecret: '%env(OAUTH_GOOGLE_SECRET)%'}
</code></pre>
<p>Et injectons ce service dans notre authenticator :</p>
<pre><code class="language-php">// src/Security/GoogleOauthAuthenticator.php
&lt;?php
declare(strict_types=1);

namespace App\Security;

use League\OAuth2\Client\Provider\Google;
use Doctrine\ORM\EntityManagerInterface;
//...
use Symfony\Component\Security\Guard\AbstractGuardAuthenticator;

final class GoogleOauthAuthenticator extends AbstractGuardAuthenticator
{
    /**
     * @var \League\OAuth2\Client\Provider\Google
     */
    private $client;
    /**
     * @var \Doctrine\ORM\EntityManagerInterface
     */
    private $entityManager;

    public function __construct(Google $client, EntityManagerInterface $entityManager)
    {
        $this-&gt;client = $client;
        $this-&gt;entityManager = $entityManager;
    }
</code></pre>
<p>Completons maintenant les diffÃ©rentes mÃ©thodes de notre <code>GoogleOauthAuthenticator</code>.</p>
<p>La mÃ©thode <code>support</code> permet de vÃ©rifier si les conditions sont bien remplies pour qu'on appelle la classe.
Dans notre cas, il s'agit de vÃ©rifier la prÃ©sence du nouvel header <code>authorization</code>.</p>
<pre><code class="language-php">    public function supports(Request $request): bool
    {
        return $request-&gt;headers-&gt;has('authorization');
    }
</code></pre>
<p>La mÃ©thode <code>getCredentials</code>  permet d'extraire les crÃ©dentials nÃ©cessaire pour la rÃ©cupÃ©ration de notre Utilisateur.</p>
<pre><code class="language-php">    public function getCredentials(Request $request)
    {
        $accessToken = explode(' ', $request-&gt;headers-&gt;get('authorization'))[1];

        return new \League\OAuth2\Client\Token\AccessToken(['access_token' =&gt; $accessToken]);
    }
</code></pre>
<blockquote>
<p>Ici, on explose le contenu du header, le token est la deuxiÃ¨me partie.</p>
</blockquote>
<p>La mÃ©thode <code>getUser</code> doit retrouver l'utilisateur Ã  partir des crÃ©dentials. C'est ici qu'on va utiliser notre nouveau service.</p>
<pre><code class="language-php">    public function getUser($credentials, UserProviderInterface $userProvider): ?UserInterface
    {
        /** @var \League\OAuth2\Client\Provider\GoogleUser $googleUser */
        $googleUser = $this-&gt;client-&gt;getResourceOwner($credentials);

        $email = $googleUser-&gt;getEmail();
		
        try {
            $user = $userProvider-&gt;loadUserByUsername($email);
        } catch (UsernameNotFoundException $exception) {
            $user = (new User())-&gt;setEmail($email);
            $this-&gt;entityManager-&gt;persist($user);
            $this-&gt;entityManager-&gt;flush();
        }

        return $user;
    }
</code></pre>
<p>Enfin, la mÃ©thode <code>checkCredential</code> doit toujours retourner <code>true</code>, et la methode <code>supportsRememberMe</code> retournera <code>false</code>.</p>
<pre><code class="language-php">    public function checkCredentials($credentials, UserInterface $user): bool
    {
        return true;
    }
    public function supportsRememberMe(): bool
    {
        return false;
    }
</code></pre>
<p>Et c'est tout. Les autres mÃ©thodes peuvent rester vide pour l'instant, il conviendra de le remplir correctement le temps venu.</p>
<p>Si dorÃ©navant, nous appelons l'endpoint <code>/api/whoami</code>, notre utilisateur va Ãªtre renvoyÃ©.</p>
<h2><a id="user-content-un-autre-oauth-provider--github" href="#un-autre-oauth-provider--github" name="un-autre-oauth-provider--github" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Un autre OAuth provider : Github</h2>
<p>La plupart du temps, nous proposons Ã  nos utilisateurs plusieurs moyen de se connecter. Voyons comment ajouter une deuxieme authentification avec Github OAuth.</p>
<p>CommenÃ§ons par <a href="https://developer.github.com/apps/building-oauth-apps/">crÃ©er une application OAuth sur Github</a> et ajoutons nos nouveaux credentials dans le fichier <code>.env</code>.</p>
<pre><code class="language-ini">#.env
#...
OAUTH_GITHUB_ID=monid
OAUTH_GITHUB_SECRET=monsecret
</code></pre>
<p>RemplaÃ§ons temporairement la configuration d'API Platform pour utiliser Github en OAuth.</p>
<pre><code class="language-yaml">#config/packages/api_platform.yaml
api_platform:
    # ...
    oauth:
        enabled: true
        clientId: '%env(OAUTH_GITHUB_ID)%'
        clientSecret: '%env(OAUTH_GITHUB_ID)%'
        type: 'oauth2'
        # The oauth flow grant type.
        flow: 'authorizationCode'
        # The oauth authentication url.
        authorizationUrl: 'https://github.com/login/oauth/authorize'
        # The oauth token url.
        tokenUrl: 'https://github.com/login/oauth/access_token'
        # The oauth scopes.
        scopes:
            'user:email': 'Allow to retrieve user email'
</code></pre>
<p>Si nous rÃ©essayons le flow OAuth depuis Swagger UI, une erreur survient :</p>
<blockquote>
<p><strong>Auth Error</strong> TypeError: Failed to fetch</p>
</blockquote>
<p>En inspectant les requÃªtes depuis l'inspecteur web, on se rend compte que l'url pour rÃ©cupÃ©rer l'accessToken ne prend pas en charge les CORS.</p>
<p>Nous devons donc crÃ©er un controlleur qui s'occupera de rÃ©cupÃ©rer notre AccessToken.</p>
<pre><code class="language-bash">php bin/console make:controller GithubTokenController --no-template
</code></pre>
<p>Et nous allons utiliser le paquet <code>league/oauth2-github</code> qui fera l'appel pour nous :</p>
<pre><code class="language-bash">composer require league/oauth2-github
</code></pre>
<p>De la mÃªme maniÃ¨re que pour Google, ajoutons ce provider en tant que service :</p>
<pre><code class="language-yaml">#config/services.yaml

services:
    # ...
    League\OAuth2\Client\Provider\Github:
        class: League\OAuth2\Client\Provider\Github
        arguments:
            - {clientId: '%env(OAUTH_GITHUB_ID)%', clientSecret: '%env(OAUTH_GITHUB_SECRET)%'}

</code></pre>
<p>Injectons ce service dans notre controller et renvoyons l'accessToken :</p>
<pre><code class="language-php">// src/Controller/GithubTokenController.php
&lt;?php
declare(strict_types=1);

namespace App\Controller;

use League\OAuth2\Client\Provider\Github;
use Symfony\Component\HttpFoundation\JsonResponse;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\Routing\Annotation\Route;

final class GithubTokenController
{
    /**
     * @Route(&quot;/github/token&quot;, name=&quot;github_token&quot;)
     */
    public function index(Request $request, Github $client): JsonResponse
    {
        return new JsonResponse(
            $client-&gt;getAccessToken('authorization_code', [
                'code' =&gt; $request-&gt;request-&gt;get('code'),
            ])
        );
    }
}
</code></pre>
<p>Et on change la valeur de tokenUrl dans la config d'API Platform par notre nouvelle route :</p>
<pre><code class="language-yaml">#config/packages/api_platform.yaml
api_platform:
    # ...
    oauth: 
        # ...
        tokenUrl: '/github/token'
</code></pre>
<p>Si nous rÃ©essayons le flow d'authorization sur Swagger UI, tout devrait bien passer maintenant.</p>
<p>Pour gÃ©rer l'authentification, nous allons devoir, comme auparavant pour Google, crÃ©er un GuardAuthenticator.</p>
<pre><code class="language-bash">php bin/console make:auth
</code></pre>
<blockquote>
<p>A la crÃ©ation, un avertissement vous prÃ©viendra du comportement lorsque nous avons plusieurs Authenticators et vous demandera de choisir l'entry_point par dÃ©faut. Choisissez celui nouvellement crÃ©Ã©.</p>
<p>Plus d'info sur <a href="https://symfony.com/doc/current/security/multiple_guard_authenticators.html">la documentation</a>.</p>
</blockquote>
<p>Le principe est le mÃªme que pour celui de Google, il faudra juste injecter le GithubProvider Ã  la place.</p>
<p>Si on essaye d'appeler l'endpoint <code>/api/whoami</code>, nous obtenons ... une erreur.</p>
<pre><code class="language-json">{
	&quot;type&quot;: &quot;https:\/\/tools.ietf.org\/html\/rfc2616#section-10&quot;,
	&quot;title&quot;: &quot;An error occurred&quot;,
	&quot;detail&quot;: &quot;invalid_request&quot;
}
</code></pre>
<p>En utilisant le profiler, on peut voir que l'authentification s'est bien passÃ©, nous avons un utilisateur loggÃ©, mais on passe ensuite dans le GoogleOAuthAuthenticator, qui essaye de rÃ©cupÃ©rer les information avec un accessToken qui vient de Github, et on a donc une exception.</p>
<p>Pour palier Ã  Ã§a, nous pouvons faire un try/catch dans les GuardAuthenticators au moment de rÃ©cuperer les utilisateurs, et retourner <code>null</code> si l'appel lÃ¨ve une erreur.</p>
<pre><code class="language-php">// src/Security/GoogleOAuthAuthenticator.php
// ...
    public function getUser($credentials, UserProviderInterface $userProvider): ?UserInterface
    {
        try {
            /** @var \League\OAuth2\Client\Provider\GoogleUser $googleUser */
            $googleUser = $this-&gt;client-&gt;getResourceOwner($credentials);
        } catch (\Throwable $throwable) {
            return null;
        }

        //...
        return $user;
    }
</code></pre>
<p>Mais nous pouvons aussi regrouper les deux Guard en un seul.
Pour cela, dans le <code>services.yaml</code>, ajoutons un tag sur nos OAuth providers :</p>
<pre><code class="language-yaml">#config/services.yaml
services:
    # ...
    League\OAuth2\Client\Provider\Google:
        class: League\OAuth2\Client\Provider\Google
        arguments:
            - {clientId: '%env(OAUTH_GOOGLE_ID)%', clientSecret: '%env(OAUTH_GOOGLE_SECRET)%'}
        tags:
            - {name: 'oauth_provider'}

    League\OAuth2\Client\Provider\Github:
        class: League\OAuth2\Client\Provider\Github
        arguments:
            - {clientId: '%env(OAUTH_GITHUB_ID)%', clientSecret: '%env(OAUTH_GITHUB_SECRET)%'}
        tags:
            - {name: 'oauth_provider'}

</code></pre>
<p>Retirons les guard actuels dans notre security.yaml</p>
<pre><code class="language-diff">#config/packages/security.yaml
security:
    # ...
    firewalls:
        #...
        main:
            anonymous: lazy
-            guard:
-                authenticators:
-                    - App\Security\GithubOAuthAuthenticator
-                    - App\Security\GoogleOauthAuthenticator
-                entry_point: App\Security\GithubOAuthAuthenticator

</code></pre>
<p>Et crÃ©ons un nouveau Guard : ChainOAuthAuthenticator.</p>
<pre><code class="language-php">// src/Security/ChainOAuthAuthenticator
&lt;?php
declare(strict_types=1);

namespace App\Security;

use App\Entity\User;
use Doctrine\ORM\EntityManagerInterface;
use League\OAuth2\Client\Token\AccessToken;
use Symfony\Component\HttpFoundation\JsonResponse;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Symfony\Component\Security\Core\Exception\AuthenticationException;
use Symfony\Component\Security\Core\Exception\UsernameNotFoundException;
use Symfony\Component\Security\Core\User\UserInterface;
use Symfony\Component\Security\Core\User\UserProviderInterface;
use Symfony\Component\Security\Guard\AbstractGuardAuthenticator;

final class ChainOAuthAuthenticator extends AbstractGuardAuthenticator
{
    /**
     * @var iterable&lt;\League\OAuth2\Client\Provider\AbstractProvider&gt;
     */
    private $oauthProviders;
    /**
     * @var \Doctrine\ORM\EntityManagerInterface
     */
    private $entityManager;

    public function __construct(iterable $oauthProviders, EntityManagerInterface $entityManager)
    {
        $this-&gt;oauthProviders = $oauthProviders;
        $this-&gt;entityManager = $entityManager;
    }

    public function supports(Request $request): bool
    {
        return $request-&gt;headers-&gt;has('authorization');
    }

    public function getCredentials(Request $request): AccessToken
    {
        $accessToken = explode(' ',$request-&gt;headers-&gt;get('authorization'))[1];

        return new AccessToken(['access_token' =&gt; $accessToken]);
    }

    public function getUser($credentials, UserProviderInterface $userProvider): ?UserInterface
    {
        $oauthUser = null;
        /** @var \League\OAuth2\Client\Provider\AbstractProvider $oauthProvider */
        foreach ($this-&gt;oauthProviders as $oauthProvider) {
            try {
                $oauthUser = $oauthProvider-&gt;getResourceOwner($credentials);
                break;
            } catch (\Throwable $throwable) {
                // This provider doesn't support current accessToken
            }
        }

        if (null === $oauthUser) {
            // No OAuth user found
            return null;
        }

        $email = $oauthUser-&gt;getEmail();

        try {
            $user = $userProvider-&gt;loadUserByUsername($email);
        } catch (UsernameNotFoundException $exception) {
            $user = (new User())-&gt;setEmail($email);
            $this-&gt;entityManager-&gt;persist($user);
            $this-&gt;entityManager-&gt;flush();
            $this-&gt;entityManager-&gt;refresh($user);
        }

        return $user;
    }

    public function checkCredentials($credentials, UserInterface $user): bool
    {
        return true;
    }

    public function onAuthenticationFailure(Request $request, AuthenticationException $exception)
    {
        $message = strtr($exception-&gt;getMessageKey(), $exception-&gt;getMessageData());

        return new JsonResponse($message, JsonResponse::HTTP_FORBIDDEN);
    }

    public function onAuthenticationSuccess(Request $request, TokenInterface $token, $providerKey)
    {
        // No need to redirect, as it's a stateless call.
        // Let the request continue to be handled by the controller
        return null;
    }

    public function start(Request $request, AuthenticationException $authException = null)
    {
        $message = 'Auth header required';
        if (null !== $authException) {
            $message = strtr($authException-&gt;getMessageKey(), $authException-&gt;getMessageData());
        }

        return new JsonResponse($message, JsonResponse::HTTP_UNAUTHORIZED);
    }

    public function supportsRememberMe(): bool
    {
        return false;
    }
}
</code></pre>
<p>Puis modifions le <code>services.yaml</code> pour injecter automatiquement nos providers taggÃ©s.</p>
<pre><code class="language-yaml">#config/services.yaml

services:
    _defaults:
        autowire: true
        autoconfigure: true
        bind:
            iterable $oauthProviders: !tagged_iterator oauth_provider
    # ...
</code></pre>
<p>Notre ChainOAuthAuthenticator s'occupera donc maintenant de tester notre AccessToken avec les diffÃ©rents OAuthProviders.</p>
<h2><a id="user-content-plusieurs-oauth-login-sur-swagger-ui" href="#plusieurs-oauth-login-sur-swagger-ui" name="plusieurs-oauth-login-sur-swagger-ui" class="heading-permalink" aria-hidden="true" title="Permalink"><svg class="heading-permalink-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Plusieurs OAuth Login sur Swagger UI</h2>
<p>Comme vu prÃ©cedemment, API Platform ne propose pas (<em>encore</em>) la possibilitÃ© de rajouter plusieurs OAuth dans sa configuration.</p>
<p>Swagger UI dans sa v2 le supporte, tout comme la v3. Cependant, dans la v2, les champs client_id et client_secret ne s'affichent pas, et nous devons pouvoir les diffÃ©renciers.</p>
<p>De mÃªme, Swagger UI propose une fonction pour initialiser ces champs, mais est limitÃ© Ã  un seul OAuth login. Donc si nous en affichons plusieurs, ils utiliseront tous les mÃªmes valeurs.</p>
<p>Pour afficher nos OAuth login sur le Swagger UI d'API Platform, nous allons donc &quot;dÃ©sactiver&quot; le support OAuth d'API Platform, et au passage activer la v3 :</p>
<pre><code class="language-yaml"># config/packages/api_platform.yaml
api_platform:
    # ...
    swagger:
        versions: [3]
    oauth:
        enabled: false
</code></pre>
<p>DÃ©finissons nos flows OAuth dans nos parametres</p>
<pre><code class="language-yaml">#config/services.yaml
parameters:
    oauths:
        github:
            type: oauth2
            description: OAuth authorization code Grant
            flows:
                authorizationCode:
                    tokenUrl: '/github/token'
                    authorizationUrl: 'https://github.com/login/oauth/authorize'
                    scopes:
                        'user:email': 'Allow to retrieve user email'
        google:
            type: oauth2
            description: OAuth authorization code Grant
            flows:
                authorizationCode:
                    tokenUrl: 'https://www.googleapis.com/oauth2/v4/token'
                    authorizationUrl: 'https://accounts.google.com/o/oauth2/v2/auth'
                    scopes:
                        'email': 'Allow to retrieve user email'
services:
    # ...
</code></pre>
<p>Et crÃ©eons un <a href="https://api-platform.com/docs/core/swagger/#overriding-the-openapi-specification">SwaggerDecorator</a>, auquel on passe notre dÃ©finition de flows OAuth</p>
<pre><code class="language-yaml"># config/services.yaml
#...
services:
    # ...
    App\Swagger\OAuthSwaggerDecorator:
        decorates: 'api_platform.swagger.normalizer.api_gateway'
        arguments: [ '@App\Swagger\OAuthSwaggerDecorator.inner', '%oauths%' ]
        autoconfigure: false
</code></pre>
<pre><code class="language-php">// src/Swagger/OAuthSwaggerDecorator.php
&lt;?php
declare(strict_types=1);

namespace App\Swagger;

use Symfony\Component\Serializer\Normalizer\NormalizerInterface;

final class OAuthSwaggerDecorator implements NormalizerInterface
{
    private $decorated;
    /**
     * @var array
     */
    private $oauths;

    public function __construct(NormalizerInterface $decorated, array $oauths)
    {
        $this-&gt;decorated = $decorated;
        $this-&gt;oauths = $oauths;
    }

    public function normalize($object, string $format = null, array $context = [])
    {
        // Retrieve swagger docs
        $docs = $this-&gt;decorated-&gt;normalize($object, $format, $context);

        // Add our flows in securitySchemes
        $docs['components']['securitySchemes'] = $this-&gt;oauths;
        $docs['security'] = [array_map(static function($value): array {
            return [];
        }, $this-&gt;oauths)];
        
        return $docs;
    }

    public function supportsNormalization($data, string $format = null)
    {
        return $this-&gt;decorated-&gt;supportsNormalization($data, $format);
    }
}
</code></pre>
<p>Swagger UI affiche maintenant les deux mode de connection OAuth dans sa popin.</p>
<p>Malheureusement, les champs clientId et clientSecret sont vide. Pour pouvoir appeler nos service, on devra les renseigner.</p>
<p>Comme dis prÃ©cedemment, Swagger UI ne supporte pas de pouvoir renseigner ces champs lorsqu'on a plusieurs authentifications. Ã‡a arrivera peut-Ãªtre un jour, suivez cette <a href="https://github.com/swagger-api/swagger-ui/issues/4690">issue</a>.</p>
<p>En attendant, nous allons tweaker l'interface pour remplir ces champs pour nous.</p>
<p>Pour cela, il va nous falloir faire un override du template SwaggerUi, injecter dedans nos information de client, et enfin ajouter des boutons pour changer Ã  la volÃ©e.</p>
<p>Pour l'override du template, crÃ©er un fichier <code>templates/bundle/ApiPlatformBundle/SwaggerUi/index.html.twig</code> :</p>
<pre><code class="language-twig">{% extends '@!ApiPlatform/SwaggerUi/index.html.twig' %}
{% block javascript %}
    {{ parent() }}
    &lt;script &gt;
        var oauths = {{ oauth_providers()|raw }};
    &lt;/script&gt;
    &lt;script src=&quot;{{ asset('swagger-oauth.js') }}&quot;&gt;&lt;/script&gt;
{% endblock %}
</code></pre>
<p>La fonction <code>oauth_providers</code> nous permet de rajouter la configuration de nos providers OAuth.
Ajoutons cette fonction :</p>
<pre><code class="language-bash">php bin/console make:twig-extension OAuthExtension
</code></pre>
<pre><code class="language-php">// src/Twig/OAuthExtension
&lt;?php
declare(strict_types=1);

namespace App\Twig;

use Twig\Extension\AbstractExtension;
use Twig\TwigFilter;
use Twig\TwigFunction;

final class OAuthExtension extends AbstractExtension
{
    /**
     * @var iterable&lt;\League\OAuth2\Client\Provider\AbstractProvider&gt;
     */
    private $oauthProviders;

    public function __construct(iterable $oauthProviders)
    {
        $this-&gt;oauthProviders = $oauthProviders;
    }

    public function getFunctions(): array
    {
        return [
            new TwigFunction('oauth_providers', [$this, 'oauthProviders']),
        ];
    }

    public function oauthProviders(): string
    {
        $data = [];
        /** @var \League\OAuth2\Client\Provider\AbstractProvider $provider */
        foreach ($this-&gt;oauthProviders as $provider)
        {
            $reflectionClass = new \ReflectionClass($provider);
            
            $clientIdProperty = $reflectionClass-&gt;getProperty('clientId');
            $clientIdProperty-&gt;setAccessible(true);

            $clientSecretProperty = $reflectionClass-&gt;getProperty('clientSecret');
            $clientSecretProperty-&gt;setAccessible(true);

            $clientId = $clientIdProperty-&gt;getValue($provider);
            $clientSecret = $clientSecretProperty-&gt;getValue($provider);

            $data[] = [
                'name' =&gt; strtolower($reflectionClass-&gt;getShortName()),
                'client_id' =&gt; $clientId,
                'client_secret' =&gt; $clientSecret
            ];
        }

        return json_encode($data);
    }
}
</code></pre>
<p>Ici, on rÃ©utilise l'injection des providers taggÃ© <code>oauth_provider</code>, afin de faire Ã©voluer directement le rendu quand on ajoutera de nouveaux provider.</p>
<p>Maintenant, rajoutons le javascript qui va crÃ©er les boutons et appeler la fonction initOauth de swagger :</p>
<pre><code class="language-js">// public/swagger-oauth.js
'use strict';

window.addEventListener('load', function() {
    // Same in init-swagger-ui provided by API Platform
    const data = JSON.parse(document.getElementById('swagger-data').innerText);
    const ui = SwaggerUIBundle({
        spec: data.spec,
        dom_id: '#swagger-ui',
        validatorUrl: null,
        oauth2RedirectUrl: data.oauth.redirectUrl,
        presets: [
            SwaggerUIBundle.presets.apis,
            SwaggerUIStandalonePreset,
        ],
        plugins: [
            SwaggerUIBundle.plugins.DownloadUrl,
        ],
        layout: 'StandaloneLayout',
    });

    const authWrapper = document.getElementsByClassName('auth-wrapper')[0];

    // Create an info about current credentials
    const info = document.createElement(&quot;p&quot;);
    let oauthTxt = &quot;Current OAuth Credentials : &quot;;
    info.innerText = oauthTxt + &quot;None&quot;;

    authWrapper.parentNode.insertBefore(info, authWrapper);

    oauths.forEach(function (elem) {
        const btn = document.createElement(&quot;button&quot;);
        btn.classList = 'btn';
        btn.innerText = 'OAuth ' + elem.name;
        btn.onclick = function() {
            ui.initOAuth({
                clientId: elem.client_id,
                clientSecret: elem.client_secret
            });
            info.innerText = oauthTxt + elem.name;
        };
        // Add btn near to authorize button
        authWrapper.appendChild(btn);
    });
});

</code></pre>
<p>Voici le rendu :</p>
<p><img src="https://user-images.githubusercontent.com/3168281/72219384-7fb3fa00-353d-11ea-8953-a1ad803f9b68.png" alt="image" /></p>
<p>Au clic sur le bouton OAuth google, les credentials de Google seront prÃ©remplis dans la popin.</p>

            </div>
                        <div class="mt-6 mb-0 text-right">
                <a href="#" class="share hidden mr-2 px-4 py-2 bg-gray-100 text-blue-500 border border-blue-500 hover:bg-blue-500 hover:text-white" data-title="ðŸ‡«ðŸ‡· API Platform, Oauth, &amp; Swagger UI">
                    <i class="fas fa-share-alt"></i>
                    Share
                </a>
                <a href="https://gist.github.com/9f453bdb14c5565baa7a20f35e23f2bc"
                   target="_blank" rel="nofollow,noopener"
                   class="px-4 py-2 bg-gray-100 text-blue-500 border border-blue-500 hover:bg-blue-500 hover:text-white">
                    <i class="fa fa-external-link-alt"></i>
                    React on gist.github.com
                </a>
            </div>
        </div>
        <div class="my-6">
    <a href="/" class="px-4 py-2 bg-gray-100 text-blue-500 border border-blue-500 hover:bg-blue-500 hover:text-white">
        <i class="fas fa-arrow-circle-left"></i>
        Back to home
    </a>
</div>

    </div>
        </main>
        <footer class="m-auto border-t border-gray-400 py-4 w-full max-w-5xl px-2 md:px-12 md:text-sm text-gray-600">
            <div class="sm:flex justify-between text-center">
                <div class="sm:w-1/2 sm:text-left">
                    Â© <a href="https://jibÃ©barth.fr">JibÃ© Barth</a>
                </div>
                <div class="w-full sm:text-center">
                    Last generation: Jul 18, 2020, 6:08:36 PM
                </div>
                <div class="sm:w-1/2 sm:text-right">
                        <a
        href="https://github.com/Jibbarth"
        title="Github"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-github text-gray-600 hover:text-black"></i>
    </a>
    <a
        href="https://twitter.com/jibbarth"
        title="Twitter"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-twitter text-gray-600 hover:text-black"></i>
    </a>
    <a
        href="https://linkedin.com/in/jibÃ©-b-772884a3"
        title="Linkedin"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-linkedin text-gray-600 hover:text-black"></i>
    </a>
    <a
        href="https://connect.symfony.com/profile/jibbarth"
        title="Symfony"
        target="_blank"
        rel="nofollow,noopener">
        <i class="fab fa-symfony text-gray-600 hover:text-black"></i>
    </a>

                </div>
            </div>
        </footer>
                        <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" rel="prefetch" crossorigin="anonymous"></script>
            <script src="/dist/runtime.js"></script><script src="/dist/1.js"></script><script src="/dist/app.js"></script>

                        <!-- Global site tag (gtag.js) - Google Analytics -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-39521443-1"></script>
            <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){dataLayer.push(arguments);}
                gtag('js', new Date());

                gtag('config', 'UA-39521443-1');
            </script>
                    
    <script src="/dist/runtime.js"></script><script src="/dist/0.js"></script><script src="/dist/gist.js"></script>
    </body>
</html>
